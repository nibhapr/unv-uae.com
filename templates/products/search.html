{% extends "base.html" %}

{% load humanize %}
{% load static %}
{% block title %}Search Products - Uniview | AIoT Solutions{% endblock %}
{% block meta_description %}Search through Uniview's extensive catalog of over 500+ innovative AIoT products. Find
industrial automation solutions, smart city technologies, and healthcare IoT integrations.{% endblock %}
{% block og_image %}/static/images/about-og-image.jpg{% endblock %}
{% block schema_url %}{% url 'products:search' %}{% endblock %}
{% block extra_meta %}
<!-- SEO Meta Tags -->
<meta name="robots" content="index, follow">
<meta name="keywords"
  content="AIoT products, industrial automation, smart city solutions, IoT integration, Uniview products, Dubai, UAE, Middle East">
<meta name="author" content="Uniview">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description"
  content="Explore innovative AIoT solutions in Dubai, UAE. Contact us for industrial automation, smart city technologies, and healthcare IoT integrations.">

<!-- Open Graph / Social Media Meta Tags -->
<meta property="og:type" content="website">
<meta property="og:title" content="Search Products - Uniview | AIoT Solutions">
<meta property="og:site_name" content="Uniview">
<meta property="og:locale" content="en_US">
<meta property="og:description" content="Discover AIoT products and solutions in Dubai, UAE.">
<meta property="og:url" content="{% url 'products:search' %}">
<meta property="og:image" content="{% static 'images/about-og-image.jpg' %}">

<!-- Twitter Card Meta Tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Search Products - Uniview | AIoT Solutions">
<meta name="twitter:description" content="Explore our extensive catalog of AIoT products in Dubai, UAE.">
<meta name="twitter:image" content="{% static 'images/about-og-image.jpg' %}">

<!-- Performance & Security Meta Tags -->
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-Security-Policy"
  content="default-src 'self'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline';">
<meta name="format-detection" content="telephone=no">
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="preconnect" href="//fonts.googleapis.com">

<!-- Apple Meta Tags -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Uniview Products">

<!-- Canonical URL -->
<link rel="canonical" href="{% url 'products:search' %}">

<!-- Language and Direction -->
<meta property="og:locale" content="en_US">
<meta http-equiv="Content-Language" content="en">

<!-- Cache Control -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<!-- Performance Improvements -->
<link rel="preload" href="{{ product.photo_main.url }}" as="image">
<link rel="preload" href="{% static 'images/about-og-image.jpg' %}" as="image">
<meta name="theme-color" content="#007bff">
{% endblock %}
{% block content %}
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Organization",
    "name": "Uniview UAE | Search Products | Uniview | Global AIoT Solutions Provider",
    "url": "https://www.unv-uae.com",
    "logo": "https://www.unv-uae.com/static/images/logo/logo.svg",
    "description": "Leading provider of AIoT solutions including security systems, surveillance cameras, industrial automation, smart city solutions, and IoT integration in UAE",
    "sameAs": [
        "https://www.linkedin.com/company/digital-link-technology-uae/",
        "https://www.instagram.com/digitallinktechnologyllc/",
        "https://www.facebook.com/people/Digital-Link-Technology-LLC/100087290161175/?mibextid=ZbWKwL"
    ],
    "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+971509162488",
        "email": "sales1@digitallink.ae",
        "contactType": "customer service",
        "availableLanguage": ["English", "Arabic"],
        "areaServed": ["AE", "OM", "BH", "SA", "KW", "QA"],
        "hoursAvailable": {
            "@type": "OpeningHoursSpecification",
            "dayOfWeek": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
            ],
            "opens": "09:00",
            "closes": "18:00"
        }
    },
    "address": {
        "@type": "PostalAddress",
        "streetAddress": "Baghlaf Building Showroom No.5, Satellite Market, Naif, Deira",
        "addressLocality": "Dubai",
        "addressRegion": "Dubai",
        "postalCode": "123421",
        "addressCountry": "AE"
    },
    "geo": {
        "@type": "GeoCoordinates",
        "latitude": "25.2744",
        "longitude": "55.3009"
    }
}
</script>

<!-- Hero Banner -->
<section class="bg-primary text-white py-5" id="about" role="banner" aria-label="Page Header">
  <div class="container">
    <div class="row">
      <div class="col-lg-7">
        <div class="py-5">
          <h1 class="display-4 text-uppercase fw-bold mb-3">Explore Our Products</h1>
          <p class="lead mb-0">Discover innovative AIoT solutions for your business needs</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Search Box Section -->
<section class="bg-white py-5 shadow-sm" role="search" aria-label="Product Search">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h2 class="mb-3 text-black" id="search-heading">Find Your Perfect Solution</h2>
        <p class="text-muted mb-4">Search through our extensive catalog of over 500+ innovative AIoT products</p>
        <form method="get" action="{% url 'products:search' %}" class="needs-validation" role="search"
          aria-labelledby="search-heading" novalidate>
          <div class="input-group mb-3 mx-auto" style="max-width: 700px;">
            <label for="search-input" class="visually-hidden">Search by Product Name or Percentage</label>
            <input type="text" id="search-input" class="form-control form-control-lg rounded-start" name="keywords"
              placeholder="Search by Product Name or Enter Percentage (e.g. 50%)"
              value="{{ request.GET.keywords|escape }}" aria-label="Search products" required minlength="1"
              autocomplete="off">
            <button class="btn btn-primary px-4" type="submit" aria-label="Submit search">
              <i class="fas fa-search me-2"></i> Search
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<!-- Products Section -->
<section class="bg-light py-5" aria-label="Product Listings">
  <div class="container">
    <div class="row">
      <div class="col-12 text-center">
        <h2 class="mb-3 text-black">Available Products</h2>
        <p class="text-muted mb-5">Browse our selection of high-quality AIoT solutions</p>
      </div>
    </div>

    <div class="row">
      {% if products %}
      {% for product in products %}
      <div class="col-md-4 col-lg-3 mb-4">
        <a href="{% url 'products:product_detail' product.slug %}" class="text-decoration-none">
          <article class="card h-100 shadow-sm transition-hover">
            <div class="position-relative overflow-hidden">
              <img class="card-img-top" src="{{ product.photo_main.url }}" alt="{{ product.name }}" loading="lazy"
                width="300" height="200" decoding="async" fetchpriority="high">
            </div>
            <div class="card-body">
              <h5 class="text-primary text-center mb-3 fw-bold">{{ product.name }}</h5>
              <div class="table-responsive">
                <table class="table table-bordered" role="presentation">
                  <tbody>
                    <tr>
                      <th scope="row" class="bg-light">Product</th>
                      <td>{{ product.name }}</td>
                    </tr>
                    <tr>
                      <th scope="row" class="bg-light">Category</th>
                      <td>{{ product.category.name }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="text-center mt-3">
                <span class="btn btn-sm btn-outline-primary">View Details</span>
              </div>
            </div>
          </article>
        </a>
      </div>
      {% endfor %}
      {% else %}
      <div class="col-md-12">
        <div class="bg-white p-5 text-center rounded shadow-sm">
          <i class="fas fa-search fa-3x text-primary mb-3"></i>
          <p class="lead mb-2">No products available at the moment.</p>
          <p class="text-muted">Please try a different search term or check back later.</p>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Pagination -->
    <div class="row">
      <div class="col-md-12">
        {% if products.has_other_pages %}
        <nav aria-label="Product navigation" class="mt-4">
          <ul class="pagination justify-content-center">
            {% if products.has_previous %}
            <li class="page-item">
              <a href="?page={{ products.previous_page_number }}{% if request.GET.keywords %}&keywords={{ request.GET.keywords|urlencode }}{% endif %}"
                class="page-link rounded-pill px-3" rel="prev" aria-label="Go to previous page">
                &laquo; Previous
              </a>
            </li>
            {% endif %}
            {% for i in products.paginator.page_range %}
            {% if products.number == i %}
            <li class="page-item active">
              <a class="page-link rounded-pill">{{ i }}</a>
            </li>
            {% else %}
            <li class="page-item">
              <a href="?page={{ i }}{% if request.GET.keywords %}&keywords={{ request.GET.keywords|urlencode }}{% endif %}"
                class="page-link rounded-pill">{{ i }}</a>
            </li>
            {% endif %}
            {% endfor %}
            {% if products.has_next %}
            <li class="page-item">
              <a href="?page={{ products.next_page_number }}{% if request.GET.keywords %}&keywords={{ request.GET.keywords|urlencode }}{% endif %}"
                class="page-link rounded-pill px-3">Next &raquo;</a>
            </li>
            {% else %}
            <li class="page-item disabled">
              <a class="page-link rounded-pill px-3">Next &raquo;</a>
            </li>
            {% endif %}
          </ul>
        </nav>
        {% endif %}
      </div>
    </div>
  </div>
</section>
{% endblock content %}